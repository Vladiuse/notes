<pre> 
m = Mock()

class MyService: ...
m = Mock(spec=MyService)       # —Ç–æ–ª—å–∫–æ –º–µ—Ç–æ–¥—ã/–∞—Ç—Ä–∏–±—É—Ç—ã, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤ MyService
m = Mock(spec_set=MyService)   # –µ—â—ë —Å—Ç—Ä–æ–∂–µ ‚Äî –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
m = Mock(a=1, b=2, c=3)        # —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–∫–∞ —Å –∞—Ç—Ä–∏–±—É–∫–∞–º–∏ m.a == 1, m.b == 2
m = Mock(side_effect=func)     # func –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ call —É –∫–ª–∞—Å—Å–∞
m = Mock(return_value=123)     # m() == 123

üß© –ü–æ–¥–º–µ–Ω–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤
m.some_method = Mock()
m.some_attr = "value"
 </pre>

### –ú–æ–∫:

<pre>
mock = Mock()

# –ú–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–∞
mock = Mock()
mock.attr = 123
assert mock.attr == 123

# –ú–æ–∫ –º–µ—Ç–æ–¥–∞
mock.method.return_value = 123
assert mock.method() == 123

# –ù–µ—Å–∫–æ–ª—å–∫–æ –≤—ã–∑–æ–≤–æ–≤
mock.method.side_effect = [1,2,3]
assert mock.method() == 1
assert mock.method() == 2
assert mock.method() == 3
mock.method() # raise StopIteration

# –≤—ã–∑–æ–≤ –æ—à–∏–±–∫–∏
mock.method.side_effect = ZeroDivisionError("boom")
mock.method() # ZeroDivisionError: boom

# —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é
def test():
    return "test"

mock.method.side_effect = test
assert mock.method()  == "test"
</pre>

## patch

### @patch

<pre>
class A:
    attr = "A_attr"
    def run(self):
        return "A_run"
# mock method
@patch("__main__.A.run", return_value=123)
def test_1(mock):
    assert A().run() == 123
# mock class
@patch("__main__.A", return_value=123)
def test_2(mock):
    assert A() == 123, f"actual: {A().run()}"

# mock attr
@patch("__main__.A.attr", 123)
def test_3():
    assert A().attr == 123
</pre>

### with patch
<pre> 
class A:
    def run(self):
        return "A_run"
# –∑–∞–ø–æ–∫–∞—Ç—å –ø–æ –ø—É—Ç–∏
with patch("__main__.A.run", return_value=123):
    assert A().run() == 123

# –∑–∞–º–æ–∫–∞—Ç—å –æ–±—å–µ–∫—Ç
with patch.object(A, "run", return_value=123):
    assert A().run() == 123

# –∑–∞–º–æ–∫–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã
with patch.multiple(X, a="x", b="x"):
    x = X()
    assert x.a == "x"
    assert x.b == "x"
</pre>


## üìò –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã Mock

| –ê—Ç—Ä–∏–±—É—Ç / –ú–µ—Ç–æ–¥             | –û–ø–∏—Å–∞–Ω–∏–µ                                    |
|-----------------------------|---------------------------------------------|
| `assert_called()`           | –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–∑–æ–≤–æ–≤                            |
| `assert_called_once()`      | –ë—ã–ª –≤—ã–∑–≤–∞–Ω –æ–¥–∏–Ω —Ä–∞–∑                         |
| `assert_called_once_with()` | –ë—ã–ª –≤—ã–∑–≤–∞–Ω –æ–¥–∏–Ω —Ä–∞–∑ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ |
| `assert_any_call()`         | –•–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤—ã–∑–æ–≤ —Å —É–∫–∞–∑–∞–Ω—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏   |
| `assert_not_called()`       | –ú–æ–∫ –Ω–µ –≤—ã–∑—ã–≤–∞–ª—Å—è                            |
| `assert_has_calls()`        | –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–∞–∫–∏–µ –≤—ã–∑–æ–≤—ã –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –±—ã—Ç—å |
| `reset_mock()`              | –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è                             |
| `return_value`              | –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—Ä–∏ –≤—ã–∑–æ–≤–µ                   |
| `side_effect`               | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å / —Ñ—É–Ω–∫—Ü–∏—è / –∏—Å–∫–ª—é—á–µ–Ω–∏–µ   |
| `called`                    | –ë—ã–ª –ª–∏ –≤—ã–∑–≤–∞–Ω                               |
| `mock_calls`                | –°–ø–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤                        |
| `call_count`                | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤                          |
| `call_args`                 | –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤—ã–∑–æ–≤–∞                  |
| `call_args_list`            | –í—Å–µ –≤—ã–∑–æ–≤—ã                                  |
| `attach_mock()`             | –í–ª–æ–∂–µ–Ω–Ω—ã–µ –º–æ–∫–∏                              |
| `configure_mock()`          | –ú–∞—Å—Å–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤             |
| `mock_add_spec()`           | –î–æ–±–∞–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ—Å—Ç—Ñ–∞–∫—Ç—É–º            |


