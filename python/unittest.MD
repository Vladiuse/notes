<pre> 
m = Mock()

class MyService: ...
m = Mock(spec=MyService)       # —Ç–æ–ª—å–∫–æ –º–µ—Ç–æ–¥—ã/–∞—Ç—Ä–∏–±—É—Ç—ã, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤ MyService
m = Mock(spec_set=MyService)   # –µ—â—ë —Å—Ç—Ä–æ–∂–µ ‚Äî –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã

üß© –ü–æ–¥–º–µ–Ω–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤
m.some_method = Mock()
m.some_attr = "value"
 </pre>


### –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞:
<pre> 
m.some_method(1, 2, key="x")
m.some_method.assert_called_once()
m.some_method.assert_called_with(1, 2, key="x")
 </pre>


### –û–¥–∏–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç
<pre> 
m.some_method.return_value = 42
print(m.some_method())  # 42
 </pre>


### –†–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –≤—ã–∑–æ–≤–∞–º
<pre> 
m.some_method.side_effect = [1, 2, 3]
print(m.some_method())  # 1
print(m.some_method())  # 2
 </pre>


### –í–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é
<pre> 
def dynamic_result(arg):
    return arg * 2

m.some_method.side_effect = dynamic_result
print(m.some_method(5))  # 10
 </pre>

### –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ
<pre> 
m.some_method.side_effect = ValueError("boom")
m.some_method()  # –ø–æ–¥–Ω–∏–º–µ—Ç ValueError("boom")
 </pre>


## üß® –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∑–æ–≤–æ–≤
<pre> 
m.some_method.called                # bool ‚Äî –±—ã–ª –ª–∏ –≤—ã–∑–≤–∞–Ω
m.some_method.call_count            # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤
m.some_method.call_args             # –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–∑–æ–≤ (args, kwargs)
m.some_method.call_args_list        # —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤
m.some_method.assert_called()       # –ø—Ä–æ—Å—Ç–æ —Ñ–∞–∫—Ç –≤—ã–∑–æ–≤–∞
m.some_method.assert_called_once()  # —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑
m.some_method.assert_called_with(1, 2)
m.some_method.assert_any_call(1, 2)
m.some_method.assert_has_calls([call(1), call(2)])
m.some_method.reset_mock()          # —Å–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–æ–≤ –∏ –≤—ã–∑–æ–≤–æ–≤
 </pre>


## üß† –ü–æ–¥–º–µ–Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ patch
<pre> 
from unittest.mock import patch

@patch("path.to.module.ClassName")
def test_something(mock_class):
    instance = mock_class.return_value
    instance.do_stuff.return_value = 123
 </pre>
### –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä:

<pre> 
with patch("path.to.module.function_name", return_value=42) as mock_func:
    assert function_name() == 42
 </pre>

### üîç –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä
<pre> 
from unittest.mock import Mock, call
import pytest

def test_mock_example():
    service = Mock()
    service.fetch.side_effect = [1, 2, ValueError("fail")]

    assert service.fetch() == 1
    assert service.fetch() == 2
    try:
        service.fetch()
    except ValueError:
        pass

    service.fetch.assert_has_calls([call(), call(), call()])
    assert service.fetch.call_count == 3
 </pre>


## üìò –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã Mock
| –ê—Ç—Ä–∏–±—É—Ç / –ú–µ—Ç–æ–¥    | –û–ø–∏—Å–∞–Ω–∏–µ                                        |
| ------------------ | ----------------------------------------------- |
| `return_value`     | –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—Ä–∏ –≤—ã–∑–æ–≤–µ                       |
| `side_effect`      | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å / —Ñ—É–Ω–∫—Ü–∏—è / –∏—Å–∫–ª—é—á–µ–Ω–∏–µ       |
| `called`           | –ë—ã–ª –ª–∏ –≤—ã–∑–≤–∞–Ω                                   |
| `call_count`       | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤                              |
| `call_args`        | –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤—ã–∑–æ–≤–∞                      |
| `call_args_list`   | –í—Å–µ –≤—ã–∑–æ–≤—ã                                      |
| `assert_called*()` | –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–∑–æ–≤–æ–≤                                |
| `reset_mock()`     | –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è                                 |
| `spec`, `spec_set` | –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã                 |
| `attach_mock()`    | –í–ª–æ–∂–µ–Ω–Ω—ã–µ –º–æ–∫–∏                                  |
| `configure_mock()` | –ú–∞—Å—Å–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤                 |
| `mock_add_spec()`  | –î–æ–±–∞–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ—Å—Ç—Ñ–∞–∫—Ç—É–º                |
| `wraps`            | –û–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç, —Å–æ—Ö—Ä–∞–Ω—è—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ |

